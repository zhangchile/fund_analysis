<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <!-- Load c3.css -->
    <link href="./css/c3.min.css" rel="stylesheet">

    <!-- Load d3.js and c3.js -->
    <script src="./js/d3.v3.min.js" charset="utf-8"></script>
    <script src="./js/c3.min.js"></script>
    <script src="./js/jquery-3.2.1.min.js"></script>
</head>
<body>
    <div class="center">
        <div id="chart" style="max-width:1100px;min-height:600px"></div>
    </div>
</body>
<script>
var data = [];
var getDate = function () {
    var date = new Date();
    var y = date.getFullYear();
    var m = date.getMonth() + 1;
    m = m < 10 ? '0' + m : m;
    var d = date.getDate();
    d = d < 10 ? ('0' + d) : d;
    return y + '-' + m + '-' + d;
};

$.get('./funddata/fundcount_'+getDate()+'.json', function (data) {
    console.log(data)
})

data = [{"id": "160222", "name": "\u56fd\u6cf0\u56fd\u8bc1\u98df\u54c1\u996e\u6599\u884c\u4e1a\u6307\u6570\u5206\u7ea7|\u6307\u6570\u578b|zs", "count": 81, "reading": 28742}, {"id": "161725", "name": "\u62db\u5546\u4e2d\u8bc1\u767d\u9152\u6307\u6570\u5206\u7ea7|\u6307\u6570\u578b|zs", "count": 903, "reading": 414254}, {"id": "167301", "name": "\u65b9\u6b63\u5bcc\u90a6\u4fdd\u9669\u4e3b\u9898\u6307\u6570\u5206\u7ea7|\u6307\u6570\u578b|zs", "count": 126, "reading": 44180}, {"id": "001632", "name": "\u5929\u5f18\u4e2d\u8bc1\u98df\u54c1\u996e\u6599\u6307\u6570C|\u6307\u6570\u578b|zs", "count": 32, "reading": 12052}, {"id": "168203", "name": "\u4e2d\u878d\u56fd\u8bc1\u94a2\u94c1\u884c\u4e1a\u6307\u6570\u5206\u7ea7|\u6307\u6570\u578b|zs", "count": 41, "reading": 69936}, {"id": "502023", "name": "\u9e4f\u534e\u94a2\u94c1\u5206\u7ea7|\u6307\u6570\u578b|zs", "count": 69, "reading": 149597}, {"id": "161724", "name": "\u62db\u5546\u4e2d\u8bc1\u7164\u70ad\u7b49\u6743\u6307\u6570\u5206\u7ea7|\u6307\u6570\u578b|zs", "count": 60, "reading": 31007}, {"id": "002907", "name": "\u5357\u65b9\u4e2d\u8bc1500\u91cf\u5316\u589e\u5f3aC|\u6307\u6570\u578b|zs", "count": 49, "reading": 171892}, {"id": "519772", "name": "\u4ea4\u94f6\u65b0\u751f\u6d3b\u529b\u7075\u6d3b\u914d\u7f6e\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 44, "reading": 53773}, {"id": "002124", "name": "\u5e7f\u53d1\u65b0\u5174\u4ea7\u4e1a\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 147, "reading": 148127}, {"id": "340007", "name": "\u5174\u5168\u793e\u4f1a\u8d23\u4efb\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 70, "reading": 225428}, {"id": "002803", "name": "\u4e1c\u65b9\u7ea2\u6caa\u6e2f\u6df1\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 96, "reading": 154197}, {"id": "340008", "name": "\u5174\u5168\u6709\u673a\u589e\u957f\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 32, "reading": 24020}, {"id": "040008", "name": "\u534e\u5b89\u7b56\u7565\u4f18\u9009\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 69, "reading": 125690}, {"id": "020026", "name": "\u56fd\u6cf0\u6210\u957f\u4f18\u9009\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 100, "reading": 88831}, {"id": "001740", "name": "\u5149\u5927\u4e2d\u56fd\u5236\u90202025\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 77, "reading": 384706}, {"id": "519961", "name": "\u957f\u4fe1\u5229\u5e7f\u6df7\u5408A|\u6df7\u5408\u578b|hh", "count": 41, "reading": 13591}, {"id": "004142", "name": "\u62db\u5546\u76db\u5408\u7075\u6d3b\u6df7\u5408A|\u6df7\u5408\u578b|hh", "count": 44, "reading": 60742}]
data = [{"id": "160222", "name": "\u56fd\u6cf0\u56fd\u8bc1\u98df\u54c1\u996e\u6599\u884c\u4e1a\u6307\u6570\u5206\u7ea7|\u6307\u6570\u578b|zs", "count": 58, "reading": 24859}, {"id": "161725", "name": "\u62db\u5546\u4e2d\u8bc1\u767d\u9152\u6307\u6570\u5206\u7ea7|\u6307\u6570\u578b|zs", "count": 858, "reading": 473182}, {"id": "001618", "name": "\u5929\u5f18\u4e2d\u8bc1\u7535\u5b50\u6307\u6570C|\u6307\u6570\u578b|zs", "count": 52, "reading": 102828}, {"id": "167301", "name": "\u65b9\u6b63\u5bcc\u90a6\u4fdd\u9669\u4e3b\u9898\u6307\u6570\u5206\u7ea7|\u6307\u6570\u578b|zs", "count": 126, "reading": 42114}, {"id": "001632", "name": "\u5929\u5f18\u4e2d\u8bc1\u98df\u54c1\u996e\u6599\u6307\u6570C|\u6307\u6570\u578b|zs", "count": 42, "reading": 18858}, {"id": "161724", "name": "\u62db\u5546\u4e2d\u8bc1\u7164\u70ad\u7b49\u6743\u6307\u6570\u5206\u7ea7|\u6307\u6570\u578b|zs", "count": 63, "reading": 23804}, {"id": "519772", "name": "\u4ea4\u94f6\u65b0\u751f\u6d3b\u529b\u7075\u6d3b\u914d\u7f6e\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 47, "reading": 39369}, {"id": "340007", "name": "\u5174\u5168\u793e\u4f1a\u8d23\u4efb\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 102, "reading": 360007}, {"id": "519690", "name": "\u4ea4\u94f6\u7a33\u5065\u914d\u7f6e\u6df7\u5408A|\u6df7\u5408\u578b|hh", "count": 40, "reading": 29125}, {"id": "002803", "name": "\u4e1c\u65b9\u7ea2\u6caa\u6e2f\u6df1\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 87, "reading": 158289}, {"id": "002851", "name": "\u5357\u65b9\u54c1\u8d28\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 43, "reading": 50598}, {"id": "002142", "name": "\u535a\u65f6\u5916\u5ef6\u589e\u957f\u4e3b\u9898\u7075\u6d3b\u914d\u7f6e\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 49, "reading": 232897}, {"id": "001972", "name": "\u524d\u6d77\u5f00\u6e90\u6caa\u6e2f\u6df1\u667a\u6167\u751f\u6d3b\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 49, "reading": 157388}, {"id": "340008", "name": "\u5174\u5168\u6709\u673a\u589e\u957f\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 33, "reading": 21889}, {"id": "040008", "name": "\u534e\u5b89\u7b56\u7565\u4f18\u9009\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 77, "reading": 45667}, {"id": "020026", "name": "\u56fd\u6cf0\u6210\u957f\u4f18\u9009\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 144, "reading": 165682}, {"id": "003704", "name": "\u5149\u5927\u4fdd\u5fb7\u4fe1\u4e8b\u4ef6\u9a71\u52a8\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 49, "reading": 92267}, {"id": "519961", "name": "\u957f\u4fe1\u5229\u5e7f\u6df7\u5408A|\u6df7\u5408\u578b|hh", "count": 61, "reading": 25810}, {"id": "003954", "name": "\u534e\u6cf0\u67cf\u745e\u4ef7\u503c\u7cbe\u900930\u6df7\u5408|\u6df7\u5408\u578b|hh", "count": 49, "reading": 102361}, {"id": "004142", "name": "\u62db\u5546\u76db\u5408\u7075\u6d3b\u6df7\u5408A|\u6df7\u5408\u578b|hh", "count": 49, "reading": 99862}]
    var chart = c3.generate({
        bindto: '#chart',
        data: {
            json: data,
            names: {
                count: '评论量',
                reading: '阅读量'
            },
            keys: {
                x: 'name',
                value:['count','reading']
            },
            axes: {
                reading: 'y2', // ADD,
            },
            order: 'asc',
            labels: true,
            types: {
                count: 'bar',
                reading: 'line'
            },
            onmouseover: function (d) {
                console.log(data[d.index].id)
            },
            onclick: function (d, element) {
                var id = data[d.index].id
                var url = 'http://fund.eastmoney.com/'+id+'.html'
                window.open(url)
            },
            selection: {
                enabled: true
            }
        },
        axis: {
            x: {
                type: 'category',
                height: 90
            },
            y2: {
                show: true, // ADD
                label: '阅读量'
            }
        },
        tooltip: {
            format: {
                title: function (x) {
                    var id = data[x].id
                    return id + '-'+data[x].name; 
                }
            }
        }
    });
</script>
</html>